(this["webpackJsonpaudio-pipes"]=this["webpackJsonpaudio-pipes"]||[]).push([[0],{26:function(e,t,n){e.exports=n.p+"25f83a8184c7a4f4d712.worklet.js"},27:function(e,t,n){e.exports=n.p+"264005fc3fbac0df3cbb.worklet.js"},28:function(e,t,n){e.exports=n.p+"7dba029d86b844d8016f.worklet.js"},29:function(e,t,n){e.exports=n.p+"2e77cfc056b8fa914a0f.worklet.js"},30:function(e,t,n){e.exports=n.p+"4ed615d1f9dca87c6212.worklet.js"},31:function(e,t,n){e.exports=n.p+"897bbdcfb2b44a667a76.worklet.js"},32:function(e,t,n){e.exports=n.p+"facaf7919522ba0e40ad.worklet.js"},33:function(e,t,n){e.exports=n.p+"cadd6a708e4d2b9947b3.worklet.js"},34:function(e,t,n){e.exports=n.p+"8db703de13a376294788.worklet.js"},35:function(e,t,n){e.exports=n.p+"f9fe33625e24ee0c7feb.worklet.js"},36:function(e,t,n){e.exports=n.p+"2f4ffd4dc2da4be65819.worklet.js"},37:function(e,t,n){e.exports=n.p+"3775d4dc70be610cb423.worklet.js"},38:function(e,t,n){e.exports=n.p+"8576755c7f889213a206.worklet.js"},39:function(e,t,n){e.exports=n.p+"fbff70cf744eb55f2ea0.worklet.js"},40:function(e,t,n){e.exports=n.p+"be6edbc3442b64609e81.worklet.js"},41:function(e,t,n){e.exports=n.p+"dc273da7391e26d43bbb.worklet.js"},51:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(15),i=n.n(o),r=(n(51),n(9)),u=n(4),s=n(5),l=n(3),d=n.n(l),f=n(13),p=n.n(f),j=n(25),b=p()((function(){return{audioContext:new j.a}})),v=n(26),m=n.n(v),h=n(27),O=n.n(h),g=n(28),x=n.n(g),y=n(29),k=n.n(y),N=n(30),C=n.n(N),w=n(31),T=n.n(w),_=n(32),S=n.n(_),A=n(33),M=n.n(A),D=n(34),E=n.n(D),R=n(35),q=n.n(R),F=n(36),B=n.n(F),W=n(37),P=n.n(W),z=n(38),L=n.n(z),I=n(39),G=n.n(I),H=n(40),Q=n.n(H),X=n(41),K=n.n(X),U=n(1);var V=function(e){var t=e.children,n=Object(a.useState)(!1),c=Object(s.a)(n,2),o=c[0],i=c[1],r=b().audioContext;Object(a.useEffect)((function(){var e=function(){var e=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.audioWorklet){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([t.audioWorklet.addModule(m.a),t.audioWorklet.addModule(O.a),t.audioWorklet.addModule(x.a),t.audioWorklet.addModule(k.a),t.audioWorklet.addModule(C.a),t.audioWorklet.addModule(T.a),t.audioWorklet.addModule(S.a),t.audioWorklet.addModule(M.a),t.audioWorklet.addModule(E.a),t.audioWorklet.addModule(q.a),t.audioWorklet.addModule(B.a),t.audioWorklet.addModule(P.a),t.audioWorklet.addModule(L.a),t.audioWorklet.addModule(G.a),t.audioWorklet.addModule(Q.a),t.audioWorklet.addModule(K.a)]);case 4:i(!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r&&e(r)}),[r]);var l=Object(a.useCallback)((function(){"suspended"===(null===r||void 0===r?void 0:r.state)&&r.resume()}),[r]);return r?o?Object(U.jsx)("div",{onClick:l,children:t}):null:Object(U.jsx)("div",{children:"Sorry, but the Web Audio API is not supported by your browser."})},Y=n(2),J=Object(a.createContext)(null);function Z(){return Object(a.useContext)(J)}var $=n(76);var ee=function(e){var t=e.children,n=c.a.useState(null),o=Object(s.a)(n,2),i=o[0],r=o[1],u=c.a.useState(),l=Object(s.a)(u,2),d=l[0],f=l[1],p=Object(a.useRef)(),j=Object($.a)(p.current,d,{placement:"bottom-start"}),b=j.styles,v=j.attributes,m=Object(a.useMemo)((function(){return{getRect:function(){return null==p.current?{top:0,left:0,right:0,bottom:0,width:0,height:0}:p.current.getBoundingClientRect()},hide:function(){r(null)},show:function(e){r(e)},setRect:function(e){p.current={getBoundingClientRect:function(){return e}}},setPopperElement:f}}),[]);return Object(U.jsxs)(J.Provider,{value:m,children:[t,Object(U.jsx)("div",Object(Y.a)(Object(Y.a)({ref:function(e){return e&&f(e)},style:b.popper},v.popper),{},{children:i}))]})},te=[{items:[{label:"Audio Buffer Source",node:"AudioBufferSource"},{label:"Audio Device",node:"AudioDeviceSource"},{label:"Gate",node:"Gate"},{label:"Keyboard",node:"Keyboard"},{label:"Metronome",node:"Metronome"},{label:"Noise",node:"Noise"},{label:"Oscillator",node:"Oscillator"},{label:"Oscillator Note",node:"OscillatorNote"}],label:"Sources"},{items:[{label:"AudioDevice",node:"Destination"},{label:"WLED",node:"Wled"}],label:"Destinations"},{items:[{label:"Biquad Filter",node:"BiquadFilter"},{label:"Channel Merger",node:"ChannelMerger"},{label:"Channel Splitter",node:"ChannelSplitter"},{label:"Clipper",node:"Clipper"},{label:"Delay",node:"Delay"},{label:"Delay Effect",node:"DelayEffect"},{label:"Dynamics Compressor",node:"DynamicsCompressor"},{label:"Equalizer",node:"Equalizer"},{label:"Gain",node:"Gain"},{label:"Quantizer",node:"Quantizer"},{label:"Raw Gain",node:"RawGain"},{label:"Rectifier",node:"Rectifier"},{label:"Sample and Hold",node:"SampleAndHold"},{label:"Sign",node:"Sign"},{label:"Stereo Panner",node:"StereoPanner"},{label:"Transformer",node:"Transformer"},{label:"Vocoder",node:"Vocoder"},{label:"Wave Shaper",node:"WaveShaper"}],label:"Effects"},{items:[{label:"ADSR",node:"ADSR"},{label:"Constant Source",node:"ConstantSource"},{label:"Envelope Follower",node:"EnvelopeFollower"},{label:"Input Switch",node:"InputSwitch"},{label:"Output Switch",node:"OutputSwitch"},{label:"XY Pad",node:"XYPad"}],label:"Controllers"},{items:[{label:"AND Gate",node:"AndGate"},{label:"Comparator",node:"Comparator"},{label:"NOT Gate",node:"NotGate"},{label:"OR Gate",node:"OrGate"},{label:"XOR Gate",node:"XorGate"}],label:"Logic"},{items:[{label:"Analyser",node:"Analyser"},{label:"Meter",node:"Meter"},{label:"Aubio",node:"Aubio"}],label:"Analysers"}];function ne(e){var t=e.addNode;return Object(U.jsx)("ul",{className:"contextMenu",children:te.map((function(e){return Object(U.jsxs)("li",{children:[e.label,Object(U.jsx)("span",{children:"\u276f"}),e.items&&Object(U.jsx)("ul",{className:"contextMenu sub",children:e.items.map((function(e){return Object(U.jsx)("li",{onClick:function(){return t(e.node)},children:e.label},e.label)}))})]},e.label)}))})}var ae=c.a.memo(ne),ce=n(7);function oe(e){var t,n;return+(null!==(t=null===(n=e.match(/-(\d+)$/))||void 0===n?void 0:n[1])&&void 0!==t?t:0)}function ie(e,t){if(!e.source||!e.target||!e.sourceHandle||!e.targetHandle)throw new Error("Invalid connection");var n=e.targetHandle.startsWith("input"),a=e.sourceHandle.startsWith("output"),c=t(e.source),o=t(e.target);if(se(c)&&a){if(!c.output)throw new Error("Invalid connection");c=c.output}if(se(o)&&n){if(!o.input)throw new Error("Invalid connection");o=o.input}if(!c||!o)throw new Error("Invalid connection");return{inputIndex:n?oe(e.targetHandle):void 0,outputIndex:oe(e.sourceHandle),source:a?c:c[e.sourceHandle],target:n?o:o[e.targetHandle]}}function re(e,t){try{var n=ie(e,t),a=n.inputIndex,c=n.outputIndex,o=n.source,i=n.target;null!=a?o.connect(i,c,a):o.connect(i,c)}catch(r){console.error(r)}}function ue(e,t){try{var n=ie(e,t),a=n.inputIndex,c=n.outputIndex,o=n.source,i=n.target;null!=a?o.disconnect(i,c,a):o.disconnect(i,c)}catch(r){console.error(r)}}function se(e){return e&&"input"in e&&"output"in e}function le(e){var t,n,a,c,o,i,r,u;se(e)?(null===(t=e.input)||void 0===t||null===(n=t.stop)||void 0===n||n.call(t),null===(a=e.output)||void 0===a||null===(c=a.stop)||void 0===c||c.call(a),null===(o=e.input)||void 0===o||o.disconnect(),null===(i=e.output)||void 0===i||i.disconnect()):(null===(r=(u=e).stop)||void 0===r||r.call(u),e.disconnect(),e instanceof AudioWorkletNode&&e.port.postMessage("stop"))}var de=p()((function(e,t){return{nodes:{},addNode:function(t,n){e((function(e){return Object(Y.a)(Object(Y.a)({},e),{},{nodes:Object(Y.a)(Object(Y.a)({},e.nodes),{},Object(ce.a)({},t,n))})}))},getNode:function(e){return t().nodes[e]},removeNode:function(n){le(t().nodes[n]),e((function(e){return{nodes:Object.fromEntries(Object.entries(e.nodes).filter((function(e){return Object(s.a)(e,1)[0]===n})))}}))}}}));function fe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=b(),o=c.audioContext,i=de(),u=i.addNode,s=i.getNode,l=i.removeNode,d=Object(r.k)((function(e){return e.edges})),f=Object(a.useMemo)((function(){return t(o)}),n);return Object(a.useEffect)((function(){u(e,f);var t=d.filter((function(t){return t.source===e||t.target===e}));return t.forEach((function(e){return re(e,s)})),function(){t.forEach((function(e){return ue(e,s)})),l(e)}}),[u,s,f,e,l]),f}var pe=n(10),je=n(77),be=n(8),ve=n(43),me=n(18),he={getItem:function(){var e=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(me.b)(t);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=null;case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setItem:function(){var e=Object(u.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(me.c)(t,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),removeItem:function(){var e=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(me.a)(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Oe={id:Object(je.a)(),elements:[],transform:{x:0,y:0,zoom:1}},ge=p()(Object(ve.persist)((function(e,t){return{elements:Oe.elements,id:Oe.id,transform:Oe.transform,set:function(t){e((function(e){return Object(Y.a)(Object(Y.a)({},e),t)}))},setElements:function(t){e((function(e){return Object(Y.a)(Object(Y.a)({},e),{},{elements:t})}))},addElement:function(t){return e((function(e){return Object(Y.a)(Object(Y.a)({},e),{},{elements:[].concat(Object(be.a)(e.elements),[t])})}))},setId:function(t){return e((function(e){return Object(Y.a)(Object(Y.a)({},e),{},{id:t})}))},setTransform:function(t){return e((function(e){return Object(Y.a)(Object(Y.a)({},e),{},{transform:t})}))},clear:function(){e((function(e){return Object(Y.a)(Object(Y.a)({},e),Oe)}))},onChangeElementFactory:function(e){return function(n){t().setElements(t().elements.map((function(t){return Object(r.i)(t)&&t.id===e?Object(Y.a)(Object(Y.a)({},t),{},{data:Object(Y.a)(Object(Y.a)({},t.data),n)}):t})))}}}}),{name:"project-storage",getStorage:function(){return he}})),xe=["children","id","inputs","outputs","title","type"];function ye(e){var t=e.children,n=e.id,c=e.inputs,o=e.outputs,i=e.title,u=e.type,s=Object(pe.a)(e,xe),l=ge(),d=l.elements,f=l.onChangeElementFactory,p=l.addElement,j=Z(),b=d.find((function(e){return e.id===n})),v=Object(a.useMemo)((function(){return{background:"#0dbed".concat(n.substr(-1))}}),[n]),m=Object(a.useCallback)((function(){if(!b)throw new Error("Node does not exist - this should never happen");var e="".concat(u,"-").concat(Object(je.a)()),t=f(e);p({id:e,data:Object(Y.a)(Object(Y.a)({},b.data),{},{onChange:t}),type:b.type,position:{x:b.position.x+qa,y:b.position.y+qa}}),j.hide()}),[j,f,b,p,u]),h=Object(a.useCallback)((function(e){e.preventDefault(),j.setRect({width:0,height:0,top:e.clientY,right:0,bottom:0,left:e.clientX}),j.show(Object(U.jsx)("ul",{className:"contextMenu",children:Object(U.jsx)("li",{onClick:m,children:"Clone"})}))}),[m,j]);return Object(U.jsxs)("div",Object(Y.a)(Object(Y.a)({className:"customNode",onClick:function(){return j.hide()},onContextMenu:h},s),{},{children:[Object(U.jsx)("div",{title:n,className:"customNode_header",children:null!==i&&void 0!==i?i:u}),Object(U.jsxs)("div",{className:"customNode_body",children:[c&&Object(U.jsx)("div",{className:"customNode_inputs",children:c.map((function(e){return Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)(r.c,{id:e,position:r.d.Left,style:v,type:"target"}),e]},e)}))}),o&&Object(U.jsx)("div",{className:"customNode_outputs",children:o.map((function(e){return Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)(r.c,{id:e,position:r.d.Right,style:v,type:"source"}),e]},e)}))})]}),t]}))}var ke=c.a.memo(ye);var Ne,Ce,we,Te=function(e,t,n,a){return fe(e,(function(a){return new j.b(a,t,Object(Y.a)(Object(Y.a)({},n),{},{processorOptions:Object(Y.a)(Object(Y.a)({},null===n||void 0===n?void 0:n.processorOptions),{},{id:e})}))}),a)};function _e(e){var t=e.data,n=e.id,c=e.selected,o=e.type,i=t.attackTime,r=void 0===i?.2:i,u=t.decayTime,s=void 0===u?.1:u,l=t.mode,d=void 0===l?Ne.Linear:l,f=t.onChange,p=t.releaseTime,j=void 0===p?.6:p,b=t.sustainLevel,v=void 0===b?.7:b,m=t.sustainOn,h=void 0===m||m,O=Te(n,"adsr-processor",{processorOptions:{sustainOn:h,mode:d}},[d,h]),g=fe(n,(function(){var e;return e={},Object(ce.a)(e,Ce.AttackTime,O.parameters.get(Ce.AttackTime)),Object(ce.a)(e,Ce.DecayTime,O.parameters.get(Ce.DecayTime)),Object(ce.a)(e,"gain",O),Object(ce.a)(e,"gate",O),Object(ce.a)(e,"input",void 0),Object(ce.a)(e,"output",void 0),Object(ce.a)(e,Ce.ReleaseTime,O.parameters.get(Ce.ReleaseTime)),Object(ce.a)(e,Ce.SustainLevel,O.parameters.get(Ce.SustainLevel)),e}),[d,h]);return Object(a.useEffect)((function(){g[Ce.AttackTime].value=r}),[g,r]),Object(a.useEffect)((function(){g[Ce.DecayTime].value=s}),[g,s]),Object(a.useEffect)((function(){g[Ce.ReleaseTime].value=j}),[g,j]),Object(a.useEffect)((function(){g[Ce.SustainLevel].value=v}),[g,v]),Object(U.jsx)(ke,{id:n,inputs:["gate",Ce.AttackTime,Ce.DecayTime,Ce.ReleaseTime,Ce.SustainLevel],outputs:["gain"],title:"ADSR",type:o,children:c&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("select",{onChange:function(e){return f({mode:e.target.value})},title:"Type",value:d,children:[Object(U.jsx)("option",{value:Ne.Exponential,children:Ne.Exponential}),Object(U.jsx)("option",{value:Ne.Linear,children:Ne.Linear}),Object(U.jsx)("option",{value:Ne.Logarithmic,children:Ne.Logarithmic})]})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("label",{children:[Object(U.jsx)("input",{checked:h,onChange:function(){return f({sustainOn:!h})},title:"Sustain",type:"checkbox"}),"sustain on"]})}),Object(U.jsxs)("div",{className:"customNode_item",style:{width:138},children:[Object(U.jsx)("input",{min:0,onChange:function(e){return f({attackTime:+e.target.value})},step:.05,style:{width:"50%"},title:"Attack time",type:"number",value:r}),Object(U.jsx)("input",{min:0,onChange:function(e){return f({decayTime:+e.target.value})},step:.05,style:{width:"50%"},title:"Decay time",type:"number",value:s})]}),Object(U.jsxs)("div",{className:"customNode_item",style:{width:138},children:[Object(U.jsx)("input",{min:0,onChange:function(e){return f({releaseTime:+e.target.value})},step:.05,style:{width:"50%"},title:"Release time",type:"number",value:j}),Object(U.jsx)("input",{max:1,min:0,onChange:function(e){return f({sustainLevel:+e.target.value})},step:.01,style:{width:"50%"},title:"Sustain level",type:"number",value:v})]})]})})}!function(e){e.Exponential="Exponential",e.Linear="Linear",e.Logarithmic="Logarithmic"}(Ne||(Ne={})),function(e){e.AttackTime="attack",e.DecayTime="decay",e.ReleaseTime="release",e.SustainLevel="sustain"}(Ce||(Ce={})),function(e){e.Attack="Attack",e.Decay="Decay",e.Release="Release",e.Sustain="Sustain"}(we||(we={}));var Se=c.a.memo(_e);function Ae(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){var e,a,c=function(){return e=e||Date.now(),Date.now()-e},o=function(){return a=requestAnimationFrame(i)},i=function(){o(),n.current&&n.current(c())};if(t)return c(),o(),function(){return cancelAnimationFrame(a)}}),[t])}var Me=["node","paused","type"];function De(e){var t=e.node,n=e.paused,c=e.type,o=Object(pe.a)(e,Me),i=Object(a.useRef)(new Uint8Array(t.frequencyBinCount)),r=Object(a.useRef)(null),u=Object(a.useCallback)((function(){var e=r.current,t=null===e||void 0===e?void 0:e.getContext("2d");e&&t&&(c===Fe.TimeDomain?function(e,t){var n=0,a=e.canvas.height,c=e.canvas.width,o=t.length,i=c/o;e.fillStyle="#000014",e.fillRect(0,0,c,256),e.lineWidth=2,e.strokeStyle="#0dbedc",e.beginPath(),e.moveTo(n,a-t[0]/128*a/2);for(var r=1;r<o;r++){var u=t[r]/128*a/2;e.lineTo(n,a-u),n+=i}e.stroke()}(t,i.current):c===Fe.Frequency&&function(e,t){var n=0,a=e.canvas.height,c=e.canvas.width,o=t.length,i=c/o;e.fillStyle="#000014",e.fillRect(0,0,c,a),e.fillStyle="#0000c8";for(var r=0;r<o;r++){var u=a*(t[r]/255),s=a-u;e.fillRect(n,s,i,u),n+=i}}(t,i.current))}),[c]),s=Object(a.useCallback)((function(){var e=t.frequencyBinCount,n=new Uint8Array(e);c===Fe.TimeDomain?t.getByteTimeDomainData(n):c===Fe.Frequency&&t.getByteFrequencyData(n),i.current=n}),[t,c]);return Ae(Object(a.useCallback)((function(){s(),u()}),[u,s]),!n),Object(U.jsx)("canvas",Object(Y.a)({ref:r,style:{display:"block",borderRadius:5,marginBottom:5}},o))}var Ee=c.a.memo(De),Re=n(44);function qe(e,t){var n=Object(a.useRef)();Object(Re.a)((function(){n.current&&n.current()})),Object(a.useMemo)((function(){n.current&&n.current();var t=e();n.current=t instanceof Function?t:void 0}),t)}var Fe,Be=function(e,t){var n=t.fftSizeExp,a=void 0===n?11:n,c=fe(e,(function(e){return e.createAnalyser()}));return qe((function(){c.fftSize=Math.pow(2,a)}),[c,a]),c};function We(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.fftSizeExp,i=void 0===o?11:o,r=t.onChange,u=t.paused,s=void 0!==u&&u,l=t.type,d=void 0===l?Fe.TimeDomain:l,f=Be(n,{fftSizeExp:i});return Object(U.jsxs)(ke,{id:n,inputs:["input","fftSize"],outputs:["output"],title:"Analyser: ".concat(d),type:c,children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)(Ee,{type:d,node:f,paused:s,height:64,width:256})}),a&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("input",{type:"range",max:"15",min:"5",onChange:function(e){return r({fftSizeExp:+e.target.value})},step:1,value:i}),Math.pow(2,i)]}),Object(U.jsxs)("div",{className:"customNode_item",style:{justifyContent:"space-between"},children:[Object(U.jsxs)("select",{onChange:function(e){return r({type:e.target.value})},title:"Type",value:d,children:[Object(U.jsx)("option",{value:Fe.Frequency,children:Fe.Frequency}),Object(U.jsx)("option",{value:Fe.TimeDomain,children:Fe.TimeDomain})]}),Object(U.jsxs)("label",{children:[Object(U.jsx)("input",{checked:s,onChange:function(e){return r({paused:!s})},title:"Pause",type:"checkbox"}),"Paused"]})]})]})]})}!function(e){e.Frequency="Frequency",e.TimeDomain="Time Domain"}(Fe||(Fe={}));var Pe=c.a.memo(We);function ze(e){var t=e.id,n=e.type;return Te(t,"and-gate-processor",{numberOfInputs:2}),Object(U.jsx)(ke,{id:t,inputs:["input-0","input-1"],outputs:["output"],title:"Gate: AND",type:n})}var Le=c.a.memo(ze);function Ie(e){var t=e.data,n=e.id,c=e.selected,o=e.type,i=t.loop,r=void 0===i||i,s=t.onChange,l=Object(a.useRef)(),f=fe(n,(function(e){return e.createGain()})),p=Object(a.useCallback)((function(e){var t;null===(t=l.current)||void 0===t||t.disconnect(),l.current=e,l.current.connect(f)}),[f]),j=Object(a.useCallback)((function(){if(l.current){var e=f.context.createBufferSource();e.buffer=l.current.buffer,e.loop=r,p(e),l.current.start()}}),[f,r,p]),b=Object(a.useCallback)((function(){try{var e;null===(e=l.current)||void 0===e||e.stop()}catch(t){}}),[]),v=Object(a.useCallback)(function(){var e=Object(u.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.context.createBufferSource(),e.t0=f.context,e.next=4,t.arrayBuffer();case 4:return e.t1=e.sent,e.next=7,e.t0.decodeAudioData.call(e.t0,e.t1);case 7:n.buffer=e.sent,n.loop=r,p(n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[f,r,p]),m=Object(a.useCallback)((function(e){e.preventDefault(),v(e.target.files[0])}),[v]),h=Object(a.useCallback)((function(e){e.preventDefault()}),[]),O=Object(a.useCallback)(function(){var e=Object(u.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=Object(be.a)(t.dataTransfer.items).filter((function(e){return"file"===e.kind}))[0].getAsFile(),v(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[v]);return Object(U.jsx)(ke,{id:n,outputs:["output"],title:"Buffer Source",type:o,onDragOver:h,onDrop:O,children:Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("button",{onClick:j,children:"\u25b6"}),Object(U.jsx)("button",{onClick:b,children:"\u25fd"})]}),c&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{onChange:m,type:"file"})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("label",{children:[Object(U.jsx)("input",{checked:r,onChange:function(){return s({loop:!r})},title:"Loop",type:"checkbox"}),"Loop"]})})]})]})})}var Ge=c.a.memo(Ie);var He=function(e,t){var n=t.detune,a=void 0===n?0:n,c=t.frequency,o=void 0===c?350:c,i=t.gain,r=void 0===i?0:i,u=t.Q,s=void 0===u?1:u,l=t.type,d=void 0===l?"lowpass":l,f=fe(e,(function(e){return e.createBiquadFilter()}));return qe((function(){f.detune.value=a}),[f,a]),qe((function(){f.frequency.value=o}),[f,o]),qe((function(){f.gain.value=r}),[f,r]),qe((function(){f.Q.value=s}),[f,s]),qe((function(){f.type=d}),[f,d]),f},Qe=["lowshelf","highshelf","peaking"],Xe=["lowpass","highpass","bandpass","peaking","notch","allpass"];function Ke(e){var t=e.data,n=e.id,c=e.selected,o=e.type,i=t.detune,r=void 0===i?0:i,u=t.gain,s=void 0===u?0:u,l=t.frequency,d=void 0===l?350:l,f=t.Q,p=void 0===f?1:f,j=t.onChange,b=t.type,v=void 0===b?"lowpass":b,m=Object(a.useRef)(null),h=He(n,{detune:r,frequency:d,gain:s,Q:p,type:v});Object(a.useEffect)((function(){var e=m.current,t=null===e||void 0===e?void 0:e.getContext("2d");if(e&&t){var n=new Float32Array(h.context.sampleRate/200).map((function(e,t){return 100*t})),a=new Float32Array(n.length),c=new Float32Array(n.length);h.getFrequencyResponse(n,a,c),function(e,t,n){var a=0,c=e.canvas.height,o=e.canvas.width,i=t.length,r=o/i;e.fillStyle="#000014",e.fillRect(0,0,o,c),e.lineWidth=1,e.strokeStyle="#ffffff77",e.beginPath(),e.moveTo(n.frequency.value/(n.context.sampleRate/2)*o,0),e.lineTo(n.frequency.value/(n.context.sampleRate/2)*o,c),e.stroke(),e.closePath(),e.lineWidth=2,e.strokeStyle="#0000c8",e.beginPath();for(var u=0;u<i;u++){var s=t[u]*c/2;e.lineTo(a,c-s),a+=r}e.stroke()}(t,a,h)}}),[h,r,s,d,p,c,v]);var O=Qe.includes(v),g=Xe.includes(v);return Object(U.jsx)(ke,{id:n,inputs:["input","detune","frequency","gain","Q"],outputs:["output"],title:"Filter: ".concat(v),type:o,children:c&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{min:-100,max:100,onChange:function(e){return j({detune:+e.target.value})},step:1,title:"Detune: ".concat(r," cents"),type:"range",value:r})}),Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("input",{min:10,max:h.context.sampleRate/2,onChange:function(e){return j({frequency:+e.target.value})},step:1,title:"Frequency: ".concat(d," Hz"),type:"range",value:d}),Object(U.jsx)("input",{type:"number",value:d,onChange:function(e){return j({frequency:+e.target.value})}})]}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{disabled:!O,min:-40,max:40,onChange:function(e){return j({gain:+e.target.value})},step:.1,title:"Gain: ".concat(s," dB"),type:"range",value:s})}),Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("input",{disabled:!g,min:1e-4,max:["lowpass","highpass"].includes(v)?10:1e3,onChange:function(e){return j({Q:+e.target.value})},step:["lowpass","highpass"].includes(v)?.1:10,title:"Q: ".concat(p),type:"range",value:p}),Object(U.jsx)("input",{type:"number",value:p,onChange:function(e){return j({Q:+e.target.value})}})]}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("select",{onChange:function(e){return j({type:e.target.value})},value:v,children:[Object(U.jsx)("option",{value:"lowpass",children:"lowpass"}),Object(U.jsx)("option",{value:"highpass",children:"highpass"}),Object(U.jsx)("option",{value:"bandpass",children:"bandpass"}),Object(U.jsx)("option",{value:"lowshelf",children:"lowshelf"}),Object(U.jsx)("option",{value:"highshelf",children:"highshelf"}),Object(U.jsx)("option",{value:"peaking",children:"peaking"}),Object(U.jsx)("option",{value:"notch",children:"notch"}),Object(U.jsx)("option",{value:"allpass",children:"allpass"})]})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("canvas",{ref:m,height:64,width:256})})]})})}var Ue=c.a.memo(Ke);var Ve=function(e,t){var n=t.inputs,a=void 0===n?2:n;return fe(e,(function(e){return e.createChannelMerger(a)}),[a])},Ye={2:"Stereo",4:"Quad",6:"5.1"};function Je(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.inputs,i=void 0===o?2:o,r=t.onChange,u=Ve(n,{inputs:i});return Object(U.jsx)(ke,{id:n,inputs:Array(u.numberOfInputs).fill(0).map((function(e,t){return"input-".concat(t)})),outputs:["output"],type:c,children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",style:{alignItems:"flex-start",flexDirection:"column"},children:Object.keys(Ye).map((function(e){return Object(U.jsxs)("label",{title:"Channel configuration",children:[Object(U.jsx)("input",{checked:i===+e,onChange:function(e){return r({inputs:+e.target.value})},type:"radio",value:+e})," ",Ye[e]]},e)}))})})})}var Ze=c.a.memo(Je);var $e=function(e,t){var n=t.outputs,a=void 0===n?2:n;return fe(e,(function(e){return e.createChannelSplitter(a)}),[a])};function et(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.onChange,i=t.outputs,r=void 0===i?2:i,u=$e(n,{outputs:r});return Object(U.jsx)(ke,{id:n,inputs:["input"],outputs:Array(u.numberOfOutputs).fill(0).map((function(e,t){return"output-".concat(t)})),type:c,children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",style:{alignItems:"flex-start",flexDirection:"column"},children:Object.keys(Ye).map((function(e){return Object(U.jsxs)("label",{title:"Channel configuration",children:[Object(U.jsx)("input",{checked:r===+e,onChange:function(e){return o({outputs:+e.target.value})},type:"radio",value:+e})," ",Ye[e]]},e)}))})})})}var tt=c.a.memo(et);var nt=function(e,t){var n=t.curve,a=void 0===n?null:n,c=t.oversample,o=void 0===c?"none":c,i=fe(e,(function(e){return e.createWaveShaper()}));return qe((function(){i.curve=a}),[i,a]),qe((function(){i.oversample=o}),[i,o]),i},at=new Float32Array([-1,1]);function ct(e){var t=e.id,n=e.type;return nt(t,{curve:at}),Object(U.jsx)(ke,{id:t,inputs:["input"],outputs:["output"],type:n})}var ot=c.a.memo(ct);function it(e){var t=e.id,n=e.type;return Te(t,"comparator-processor",{numberOfInputs:2}),Object(U.jsx)(ke,{id:t,inputs:["input-0","input-1"],outputs:["output"],title:"Comparator",type:n})}var rt=c.a.memo(it);var ut=function(e,t){var n=t.offset,a=void 0===n?0:n,c=fe(e,(function(e){return e.createConstantSource()}));return qe((function(){return c.start(),function(){return c.stop()}}),[c]),qe((function(){c.offset.value=a}),[c,a]),c};function st(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.offset,i=void 0===o?1:o,r=t.onChange;return ut(n,{offset:i}),Object(U.jsx)(ke,{id:n,outputs:["output"],title:"Constant: ".concat(i),type:c,children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{onChange:function(e){return r({offset:+e.target.value})},style:{width:"100%"},title:"Offset",type:"number",value:i})})})})}var lt=c.a.memo(st);var dt=function(e,t){var n=t.delayTime,a=void 0===n?1:n,c=t.maxDelayTime,o=void 0===c?1:c,i=fe(e,(function(e){return e.createDelay(o)}),[o]);return qe((function(){i.delayTime.value=a}),[i,a]),i};function ft(e){return Math.max(.001,Math.min(179.999,e))}function pt(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.delayTime,i=void 0===o?1:o,r=t.maxDelayTime,u=void 0===r?1:r,s=t.onChange,l=dt(n,{delayTime:i,maxDelayTime:u});return Object(U.jsx)(ke,{id:n,inputs:["input","delayTime"],outputs:["output"],title:"Delay: ".concat(i," s"),type:c,children:a&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{max:l.delayTime.maxValue,min:l.delayTime.minValue,step:ft(u)/10,onChange:function(e){return s({delayTime:+e.target.value})},title:"Delay: ".concat(i," s"),type:"range",value:i})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{onChange:function(e){return s({maxDelayTime:+e.target.value})},max:0,min:180,title:"Max delay",type:"number",value:ft(u)})})]})})}var jt,bt=c.a.memo(pt),vt=["onChange","type","value"];!function(e){e.Linear="Linear",e.Log="Log"}(jt||(jt={}));var mt=function(e){var t=e.onChange,n=e.type,c=e.value,o=Object(pe.a)(e,vt),i=.001,r=c;n===jt.Log&&(i=9/(1/i),r=function(e){return(Math.pow(10,e)-1)/9}(r));var u=Object(a.useCallback)((function(e){var a=+e.target.value;n===jt.Log&&(a=function(e){return Math.log10(1+9*e)}(a)),t(a)}),[t,n]);return Object(U.jsx)("input",Object(Y.a)(Object(Y.a)({},o),{},{type:"range",max:1,min:0,step:i,onChange:u,value:r}))};var ht=function(e,t){var n=t.gain,a=void 0===n?1:n,c=t.instant,o=void 0!==c&&c,i=fe(e,(function(e){return e.createGain()}));return qe((function(){o?i.gain.value=a:i.gain.setTargetAtTime(a,i.context.currentTime,.015)}),[i,a,o]),i};function Ot(e){return Math.pow(10,e/20)}function gt(e){return 20*Math.log10(Math.abs(e))}function xt(e){var t=e.data,n=e.id,c=e.selected,o=e.type,i=t.delayTime,r=void 0===i?.2:i,u=t.feedback,s=void 0===u?.7:u,l=t.mix,d=void 0===l?.5:l,f=t.onChange,p=ht("".concat(n,"_input"),{}),j=ht("".concat(n,"_output"),{}),b=ht("".concat(n,"_dry"),{gain:Math.cos(.5*d*Math.PI)}),v=ht("".concat(n,"_wet"),{gain:Math.cos(.5*(1-d)*Math.PI)}),m=dt("".concat(n,"_delay"),{delayTime:r}),h=ht("".concat(n,"_feedback"),{gain:s});return Object(a.useEffect)((function(){p.connect(b),b.connect(j)}),[b,p,j]),Object(a.useEffect)((function(){p.connect(m),m.connect(v),v.connect(j)}),[m,p,j,v]),Object(a.useEffect)((function(){v.connect(h),h.connect(m)}),[m,h,v]),fe(n,(function(){return{input:p,output:j}}),[p,j]),Object(U.jsx)(ke,{id:n,inputs:["input"],outputs:["output"],title:"DelayEffect",type:o,children:c&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{max:"1",min:"0",onChange:function(e){return f({mix:+e.target.value})},step:"0.01",title:"Mix: ".concat(100*(1-d),"% dry / ").concat(100*d,"% wet"),type:"range",value:d})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{max:"1",min:"0",onChange:function(e){return f({delayTime:+e.target.value})},step:"0.01",title:"Delay: ".concat(r," s"),type:"range",value:r})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)(mt,{onChange:function(e){return f({feedback:e})},title:"Feedback: ".concat(gt(s).toFixed(2)," dB"),type:jt.Linear,value:s})})]})})}var yt=c.a.memo(xt);var kt=function(e){return fe(e,(function(e){return e.destination}))};function Nt(e){var t=e.id,n=e.type,c=e.selected;kt(t);var o=Object(a.useState)([]),i=Object(s.a)(o,2),r=i[0],u=i[1];return Object(a.useEffect)((function(){navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((function(e){e.length&&u(e.filter((function(e){return"audiooutput"===e.kind})))})).catch((function(e){console.log(e.name+": "+e.message)})):console.log("enumerateDevices() not supported.")}),[]),Object(U.jsx)(ke,{id:t,inputs:["input"],type:n,title:"Destination: Audio Device",children:c&&r.length>0&&Object(U.jsx)("select",{children:r&&r.map((function(e){return Object(U.jsx)("option",{children:e.label})}))})})}var Ct=c.a.memo(Nt);var wt=function(e,t){var n=t.attack,a=void 0===n?.003:n,c=t.knee,o=void 0===c?30:c,i=t.ratio,r=void 0===i?12:i,u=t.release,s=void 0===u?.25:u,l=t.threshold,d=void 0===l?-24:l,f=fe(e,(function(e){return e.createDynamicsCompressor()}));return qe((function(){f.threshold.value=d}),[f,d]),qe((function(){f.knee.value=o}),[f,o]),qe((function(){f.ratio.value=r}),[f,r]),qe((function(){f.attack.value=a}),[f,a]),qe((function(){f.release.value=s}),[f,s]),f};function Tt(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.attack,i=void 0===o?.003:o,r=t.knee,u=void 0===r?30:r,s=t.onChange,l=t.ratio,d=void 0===l?12:l,f=t.release,p=void 0===f?.25:f,j=t.threshold,b=void 0===j?-24:j;return wt(n,{attack:i,knee:u,ratio:d,release:p,threshold:b}),Object(U.jsx)(ke,{id:n,inputs:["input","threshold","knee","ratio","attack","release"],outputs:["output"],type:c,children:a&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{min:"-100",max:"0",onChange:function(e){return s({threshold:+e.target.value})},step:"1",title:"Threshold: ".concat(b," dB"),type:"range",value:b})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{min:"0",max:"40",onChange:function(e){return s({knee:+e.target.value})},step:"1",title:"Knee: ".concat(u," dB"),type:"range",value:u})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{min:"1",max:"20",onChange:function(e){return s({ratio:+e.target.value})},step:"1",title:"Ratio: ".concat(d," dB"),type:"range",value:d})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{min:"0",max:"1",onChange:function(e){return s({attack:+e.target.value})},step:"0.001",title:"Attack: ".concat(i," s"),type:"range",value:i})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{min:"0",max:"1",onChange:function(e){return s({release:+e.target.value})},step:"0.001",title:"Release: ".concat(p," s"),type:"range",value:p})})]})})}var _t,St,At=c.a.memo(Tt);!function(e){e.AttackTime="attack",e.ReleaseTime="release"}(St||(St={}));var Mt=(_t={},Object(ce.a)(_t,St.AttackTime,2e-4),Object(ce.a)(_t,St.ReleaseTime,4e-4),_t);function Dt(e){var t=e.id,n=e.type,c=e.data,o=e.selected,i=c.attack,r=void 0===i?Mt.attack:i,u=c.release,s=void 0===u?Mt.release:u,l=c.onChange,d="worklet_".concat(t),f=Te(d,"envelope-follower"),p=fe(t,(function(){var e;return e={},Object(ce.a)(e,St.AttackTime,f.parameters.get(St.AttackTime)),Object(ce.a)(e,St.ReleaseTime,f.parameters.get(St.ReleaseTime)),Object(ce.a)(e,"input",f),Object(ce.a)(e,"output",f),e}),[f]);return Object(a.useEffect)((function(){p[St.AttackTime].value=r}),[p,r]),Object(a.useEffect)((function(){p[St.ReleaseTime].value=s}),[p,s]),Object(U.jsx)(ke,{id:t,inputs:["input",St.AttackTime,St.ReleaseTime],outputs:["output"],title:"Envelope Follower",type:n,children:o&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{min:0,onChange:function(e){return l(Object(ce.a)({},St.AttackTime,+e.target.value))},step:.05,style:{width:"50%"},title:"Attack time",type:"number",value:r})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{min:0,onChange:function(e){return l(Object(ce.a)({},St.ReleaseTime,+e.target.value))},step:.05,style:{width:"50%"},title:"Release time",type:"number",value:s})})]})})}var Et=c.a.memo(Dt),Rt=n(14),qt=[32,64,125,250,500,1e3,2e3,4e3,8e3,16e3],Ft=qt,Bt=Array(qt.length).fill(0);function Wt(e){var t=Math.pow(2,e);return Math.sqrt(t)/(t-1)}function Pt(e){var t=e.data,n=e.id,c=e.selected,o=e.type,i=t.bandwidth,r=void 0===i?1:i,u=t.gains,s=void 0===u?Bt:u,l=t.onChange,d=ht("".concat(n,"_input"),{}),f=ht("".concat(n,"_output"),{}),p=Ft.map((function(e,t,a){var c=0===t,o=t===a.length-1,i=!c&&!o?s[t]:0,u=c?"lowshelf":o?"highshelf":"peaking",l=Wt(r);return He("".concat(n,"_filter_").concat(e),{frequency:e,gain:i,type:u,Q:l})}));return Object(a.useEffect)((function(){p.concat(f).reduce((function(e,t){return e.connect(t)}),d)}),[d,f].concat(Object(be.a)(p))),fe(n,(function(){return{input:d,output:f}}),[d,f]),Object(a.useEffect)((function(){p.forEach((function(e,t){e.gain.setTargetAtTime(s[t],e.context.currentTime,.015)}))}),[p,s]),Object(a.useEffect)((function(){p.forEach((function(e){e.Q.setTargetAtTime(Wt(r),e.context.currentTime,.015)}))}),[p,r]),Object(U.jsx)(ke,{id:n,inputs:["input"],outputs:["output"],title:"EQ",type:o,children:c&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("div",{className:"equalizer",children:p.map((function(e,t){return Object(U.jsxs)("div",{children:[Object(U.jsx)("input",{max:12,min:-12,onChange:function(e){return l({gains:Object(Rt.a)(s,(function(n){n[t]=+e.target.value}))})},step:.1,title:"Gain: ".concat(s[t]," dB"),type:"range",value:s[t]}),(n=e.frequency.value,n>=1e3?"".concat(Math.floor(n/1e3),"k"):"".concat(n))]},t);var n}))})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{max:4,min:.5,step:.5,onChange:function(e){return l({bandwidth:+e.target.value})},title:"Bandwidth: ".concat(r," octaves"),type:"range",value:r})})]})})}var zt=c.a.memo(Pt);function Lt(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.gain,i=void 0===o?1:o,r=t.onChange,u=t.type,s=void 0===u?jt.Log:u,l="Gain: ".concat(gt(i).toFixed(2)||0," dB");return ht(n,{gain:i}),Object(U.jsx)(ke,{id:n,inputs:["input","gain"],outputs:["output"],title:l,type:c,children:a&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)(mt,{onChange:function(e){return r({gain:e})},title:l,type:s,value:i})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("select",{onChange:function(e){return r({type:e.target.value})},title:"Type",value:s,children:[Object(U.jsx)("option",{value:jt.Linear,children:jt.Linear}),Object(U.jsx)("option",{value:jt.Log,children:jt.Log})]})})]})})}var It=c.a.memo(Lt);function Gt(e){var t=e.data,n=e.id,c=e.type,o=t.isOn,i=void 0!==o&&o,r=t.onChange,u=ut(n,{});Object(a.useEffect)((function(){u.offset.setTargetAtTime(i?1:0,u.context.currentTime,.015)}),[u,i]);var s=Object(a.useCallback)((function(e){"repeat"in e&&e.repeat||r({isOn:!0})}),[r]),l=Object(a.useCallback)((function(){return r({isOn:!1})}),[r]);return Object(U.jsx)(ke,{id:n,outputs:["output"],title:"Gate",type:c,children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("button",{onMouseDown:s,onMouseUp:l,onKeyDown:s,onKeyUp:l,children:["trigger ",i?"off":"on"]})})})}var Ht=c.a.memo(Gt);var Qt=function(e){var t=e.checked,n=e.labelOff,a=void 0===n?"off":n,c=e.labelOn,o=void 0===c?"on":c,i=e.onChange;return Object(U.jsxs)("label",{className:"toggle",children:[Object(U.jsx)("input",{checked:t,onChange:i,type:"checkbox"}),Object(U.jsx)("span",{className:"option",children:o}),Object(U.jsx)("span",{className:"option",children:a})]})};function Xt(e){var t=e.data,n=e.id,c=e.selected,o=e.type,i=t.input,r=void 0===i?"A":i,u=t.onChange,s=ht("".concat(n,"_output"),{}),l=ht("".concat(n,"_inputA"),{}),d=ht("".concat(n,"_inputB"),{});Object(a.useEffect)((function(){l.connect(s),d.connect(s)}),[l,d,s]);var f=Object(a.useCallback)((function(){return u({input:"A"===r?"B":"A"})}),[u,r]);return Object(a.useEffect)((function(){"A"===r?(l.gain.setTargetAtTime(1,l.context.currentTime,.015),d.gain.setTargetAtTime(0,d.context.currentTime,.015)):(l.gain.setTargetAtTime(0,l.context.currentTime,.015),d.gain.setTargetAtTime(1,d.context.currentTime,.015))}),[r,l,d]),fe(n,(function(){return{input:void 0,A:l,B:d,output:s}}),[l,d,s]),Object(U.jsx)(ke,{id:n,inputs:["A","B"],outputs:["output"],title:"Input: ".concat(r),type:o,children:c&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)(Qt,{checked:"A"===r,labelOff:"B",labelOn:"A",onChange:f})})})})}var Kt,Ut,Vt=c.a.memo(Xt),Yt=["C","C\u266f","D","D\u266f","E","F","F\u266f","G","G\u266f","A","A\u266f","B"];function Jt(e){if(e<0||e>11)throw new RangeError("Twelfth must be between 0 and 11, is ".concat(e))}function Zt(e,t){!function(e){if(e<0||e>10)throw new RangeError("Octave must be between 0 and 10, is ".concat(e))}(e),Jt(t);return 16.3516*Math.pow(2,e+t/12)}function $t(e){return Jt(e),Yt[e]}!function(e){e[e.Whole="\ueca2"]="Whole",e[e.Half="\ueca3"]="Half",e[e.Quarter="\ueca5"]="Quarter",e[e.Sixteenth="\ueca9"]="Sixteenth",e[e.Eight="\ueca7"]="Eight"}(Kt||(Kt={})),function(e){e[e.Whole=1]="Whole",e[e.Half=2]="Half",e[e.Quarter=4]="Quarter",e[e.Eight=8]="Eight",e[e.Sixteenth=16]="Sixteenth"}(Ut||(Ut={}));var en={display:"inline-block",textAlign:"center",width:"0.7em"},tn=Object(Y.a)(Object(Y.a)({},en),{},{verticalAlign:"sub"}),nn=Object(Y.a)(Object(Y.a)({},en),{},{transform:"translateX(-100%)",verticalAlign:"super"});function an(e){var t=e.detailed,n=void 0!==t&&t,a=e.detune,c=void 0===a?0:a,o=e.octave,i=e.twelfth,r=$t(i).split(""),u=Object(s.a)(r,2),l=u[0],d=u[1],f=Zt(o,i),p=f*Math.pow(2,c/1200);return Object(U.jsxs)("span",{children:[l,Object(U.jsx)("small",{style:tn,children:o}),d&&Object(U.jsx)("small",{style:nn,children:d}),n&&Object(U.jsxs)(U.Fragment,{children:["\xa0",Object(U.jsxs)("small",{children:["(",f.toFixed(2)," Hz",0!==c&&Object(U.jsxs)(U.Fragment,{children:[" \u2192 ",p.toFixed(2)," Hz"]}),")"]})]})]})}var cn=c.a.memo(an),on=(n(62),[16,28,40,64,88]);function rn(e){var t=e.data,n=e.id,c=e.type,o=t.keys,i=void 0===o?16:o,r=t.octave,u=void 0===r?2:r,s=t.onChange,l=ut("".concat(n,"_gate"),{}),d=ut("".concat(n,"_frequency"),{}),f=Object(a.useCallback)((function(e,t){var n=d.context,a=Zt(e,t);d.offset.setTargetAtTime(a,n.currentTime,.015)}),[d]),p=Object(a.useCallback)((function(){l.offset.value=1}),[l]),j=Object(a.useCallback)((function(){l.offset.value=0}),[l]);return fe(n,(function(){return{frequency:d,gate:l,input:void 0,output:void 0}}),[d,l]),Object(U.jsx)(ke,{id:n,outputs:["frequency","gate"],title:"Keyboard",type:c,children:Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("div",{className:"keyboard",onMouseDown:p,onKeyDown:function(e){switch(e.key){case"a":f(1,9),p();break;case"w":f(1,10),p();break;case"s":f(1,11),p();break;case"d":f(2,0),p();break;case"r":f(2,1),p();break;case"f":f(2,2),p();break;case"t":f(2,3),p();break;case"g":f(2,4),p();break;case"h":f(2,5),p();break;case"u":f(2,6),p();break;case"j":f(2,7),p();break;case"i":f(2,8),p();break;case"k":f(2,9),p();break;case"o":f(2,10),p();break;case"l":f(2,11),p();break;case"\xf6":f(3,0),p()}},onKeyUp:function(e){e.key,j()},onMouseLeave:j,onMouseUp:j,children:Array(i).fill(null).map((function(e,t){var n=((t+-3)%12+12)%12,a=u+Math.floor((t+-3)/12),c=[1,3,6,8,10].includes(n)?"key key-black":"key key-white";return console.log(a,n),Object(U.jsx)("button",{className:c,onMouseEnter:function(){return f(a,n)},children:Object(U.jsx)(cn,{octave:a,twelfth:n})},"".concat(a,"_").concat(n))}))})}),Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("input",{min:1,max:6,onChange:function(e){return s({octave:+e.target.value})},style:{width:"50%"},title:"Octave",type:"number",value:u}),Object(U.jsx)("select",{onChange:function(e){return s({keys:+e.target.value})},style:{width:"50%"},title:"Keys",value:i,children:on.map((function(e){return Object(U.jsx)("option",{value:e,children:e},e)}))})]})]})})}var un,sn=c.a.memo(rn);var ln=null!==(un=window.devicePixelRatio)&&void 0!==un?un:1;function dn(e,t){e.setTransform(ln,0,0,ln,0,0),e.fillStyle="#000000",e.font="10px Arial",e.strokeStyle="#000000",e.textAlign="right",e.textBaseline="middle",e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore(),Array(55).fill(void 0).forEach((function(t,n){var a=[0,6,12,18,30,42,54].includes(n),c=a?1:.5,o=a?6:3,i="".concat(6-n),r=2*n+5.5,u=17+(a?0:3),s=r;a&&e.fillText(i,15,s),e.lineWidth=c,e.fillRect(0+u,r+0,o,c)})),t.forEach((function(t,n){Array(55).fill(void 0).forEach((function(a,c){var o,i=6-c,r=Math.min(Math.max(120*(o=Math.max(0,-i/10),Math.log10(1+9*o)),0),120).toFixed(0),u=gt(t)>=i?"50%":"0%";e.fillStyle="hsl(".concat(r,", 50%, ").concat(u,")"),e.fillRect(27*(n+1)-2,2*c+5,25,2)}))}))}function fn(e){var t=e.id,n=e.type,c=Object(a.useRef)(null),o=Object(a.useRef)([]),i=Object(a.useState)(1),r=Object(s.a)(i,2),u=r[0],l=r[1],d=27*(u+1),f=Te(t,"meter-processor",{numberOfOutputs:0}),p=Object(a.useCallback)((function(e){var t=e.data;"channels"===t.type&&t.payload.channels!==u&&l(t.payload.channels),"level"===t.type&&(o.current[t.payload.channel]=t.payload.level)}),[u]);return Object(a.useEffect)((function(){f.port.onmessage=p}),[f,p]),Ae(Object(a.useCallback)((function(){var e=c.current,t=null===e||void 0===e?void 0:e.getContext("2d");e&&t&&dn(t,o.current.slice(0,u))}),[u]),!0),Object(U.jsx)(ke,{id:t,inputs:["input"],title:"Meter",type:n,children:Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("canvas",{ref:c,width:ln*d,height:120*ln,style:{height:120,width:d}})})})})}var pn=c.a.memo(fn),jn=n(6),bn=(n(63),{fontFamily:"Bravura",fontSize:20,height:32,lineHeight:2,padding:0,width:32});function vn(e){var t=e.data,n=e.id,c=e.selected,o=e.type,i=t.beatsPerMeasure,r=void 0===i?4:i,u=t.beatsPerMinute,s=void 0===u?120:u,l=t.notes,d=void 0===l?[Ut.Quarter]:l,f=t.onChange,p=fe(n,(function(e){var t,n=60/s,a=n*r,c=e.createBuffer(1,e.sampleRate*a,e.sampleRate),o=c.getChannelData(0),i=Object(jn.a)(d);try{for(i.s();!(t=i.n()).done;)for(var u=t.value,l=n*Ut.Quarter/u,f=e.sampleRate*l,p=880*u/Ut.Quarter,j=r*u/Ut.Quarter,b=0,v=1,m=0;m<j;m++)for(var h=0;h<f;h++){var O=0===m?1.33*p:p,g=h+Math.floor(m*f),x=1/d.length,y=Math.min(x,h/(.015*e.sampleRate));o[g]+=Math.sin(b)*v,b+=2*Math.PI*O/e.sampleRate,v=Math.max(y-h/f,0)}}catch(N){i.e(N)}finally{i.f()}var k=e.createBufferSource();return k.buffer=c,k.loop=!0,k.loopEnd=a,k}),[r,d.length,s]);Object(a.useEffect)((function(){return p.start(),function(){return p.stop()}}),[p]);var j=Object(a.useCallback)((function(e){return f({notes:d.includes(e)?d.filter((function(t){return t!==e})):d.concat(e)})}),[d,f]);return Object(U.jsx)(ke,{id:n,outputs:["output"],title:"Metronome: ".concat(s," BPM"),type:o,children:c&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("input",{max:208,min:40,onChange:function(e){return f({beatsPerMinute:+e.target.value})},title:"Beats Per Minute",type:"number",value:s}),Object(U.jsx)("input",{max:8,min:1,onChange:function(e){return f({beatsPerMeasure:+e.target.value})},title:"Beats Per Measure",type:"number",value:r})]}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("span",{style:{alignItems:"center",display:"flex",justifyContent:"space-between"},children:[Ut.Whole,Ut.Half,Ut.Quarter,Ut.Eight,Ut.Sixteenth].map((function(e){return Object(U.jsx)("button",{onClick:function(){return j(e)},style:Object(Y.a)(Object(Y.a)({},bn),{},{color:d.includes(e)?"#00d":"#d00"}),title:"".concat(Ut[e]," note"),children:Kt[Ut[e]]},e)}))})})]})})}var mn,hn=c.a.memo(vn);function On(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.onChange,i=t.type,r=void 0===i?mn.White:i;return Te(n,"noise-processor",{numberOfInputs:0,processorOptions:{type:r}},[r]),Object(U.jsx)(ke,{id:n,outputs:["output"],title:"Noise: ".concat(r),type:c,children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("select",{onChange:function(e){return o({type:e.target.value})},title:"Type",value:r,children:[Object(U.jsx)("option",{value:mn.White,children:mn.White}),Object(U.jsx)("option",{value:mn.Pink,children:mn.Pink}),Object(U.jsx)("option",{value:mn.Brown,children:mn.Brown})]})})})})}!function(e){e.Brown="Brown",e.Pink="Pink",e.White="White"}(mn||(mn={}));var gn=c.a.memo(On);function xn(e){var t=e.id,n=e.type;return Te(t,"not-gate-processor"),Object(U.jsx)(ke,{id:t,inputs:["input"],outputs:["output"],title:"Gate: NOT",type:n})}var yn=c.a.memo(xn);function kn(e){var t=e.id,n=e.type;return Te(t,"or-gate-processor",{numberOfInputs:2}),Object(U.jsx)(ke,{id:t,inputs:["input-0","input-1"],outputs:["output"],title:"Gate: OR",type:n})}var Nn=c.a.memo(kn);var Cn=function(e,t){var n=t.detune,c=void 0===n?0:n,o=t.frequency,i=void 0===o?440:o,r=t.type,u=void 0===r?"sine":r,s=fe(e,(function(e){return e.createOscillator()}));return Object(a.useEffect)((function(){return s.start(),function(){return s.stop()}}),[s]),qe((function(){s.detune.value=c}),[s,c]),qe((function(){s.frequency.value=i}),[s,i]),qe((function(){s.type=u}),[s,u]),s};function wn(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.detune,i=void 0===o?0:o,r=t.frequency,u=void 0===r?440:r,s=t.onChange,l=t.type,d=void 0===l?"sine":l,f=u*Math.pow(2,i/1200);return Cn(n,{detune:i,frequency:u,type:d}),Object(U.jsx)(ke,{id:n,inputs:["detune","frequency"],outputs:["output"],title:"".concat(f.toFixed(2)," Hz ").concat(d),type:c,children:a&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{max:100,min:-100,onChange:function(e){return s({detune:+e.target.value})},step:1,style:{width:"100%"},title:"Detune: ".concat(i," cents"),type:"range",value:i})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{max:2e4,min:0,onChange:function(e){return s({frequency:+e.target.value})},title:"Frequency",type:"number",value:u})}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("select",{onChange:function(e){return s({type:e.target.value})},title:"Wave",value:d,children:[Object(U.jsx)("option",{value:"sawtooth",children:"sawtooth"}),Object(U.jsx)("option",{value:"square",children:"square"}),Object(U.jsx)("option",{value:"sine",children:"sine"}),Object(U.jsx)("option",{value:"triangle",children:"triangle"})]})})]})})}var Tn=c.a.memo(wn);function _n(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.detune,i=void 0===o?0:o,r=t.octave,u=void 0===r?4:r,s=t.onChange,l=t.twelfth,d=void 0===l?0:l,f=t.type,p=void 0===f?"sine":f,j=Zt(u,d);return Cn(n,{detune:i,frequency:j,type:p}),Object(U.jsx)(ke,{id:n,inputs:["detune"],outputs:["output"],title:Object(U.jsx)(cn,{detailed:!0,detune:i,octave:u,twelfth:d}),type:c,children:a&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{max:100,min:-100,onChange:function(e){return s({detune:+e.target.value})},step:1,style:{width:"100%"},title:"Detune: ".concat(i," cents"),type:"range",value:i})}),Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("select",{onChange:function(e){return s({twelfth:+e.target.value})},style:{width:"50%"},title:"Note",value:d,children:Array(12).fill(0).map((function(e,t){return Object(U.jsx)("option",{value:t,children:$t(t)},t)}))}),Object(U.jsx)("select",{onChange:function(e){return s({octave:+e.target.value})},style:{width:"50%"},title:"Octave",value:u,children:Array(11).fill(0).map((function(e,t){return Object(U.jsx)("option",{value:t,children:t},t)}))})]}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("select",{onChange:function(e){return s({type:e.target.value})},style:{width:"100%"},title:"Wave",value:p,children:[Object(U.jsx)("option",{value:"sawtooth",children:"sawtooth"}),Object(U.jsx)("option",{value:"square",children:"square"}),Object(U.jsx)("option",{value:"sine",children:"sine"}),Object(U.jsx)("option",{value:"triangle",children:"triangle"})]})})]})})}var Sn=c.a.memo(_n);function An(e){var t=e.data,n=e.id,c=e.selected,o=e.type,i=t.onChange,r=t.output,u=void 0===r?"A":r,s=ht("".concat(n,"_input"),{}),l=ht("".concat(n,"_outputA"),{}),d=ht("".concat(n,"_outputB"),{});Object(a.useEffect)((function(){s.connect(l),s.connect(d)}),[s,l,d]);var f=Object(a.useCallback)((function(){return i({output:"A"===u?"B":"A"})}),[i,u]);return Object(a.useEffect)((function(){"A"===u?(l.gain.setTargetAtTime(1,l.context.currentTime,.015),d.gain.setTargetAtTime(0,d.context.currentTime,.015)):(l.gain.setTargetAtTime(0,l.context.currentTime,.015),d.gain.setTargetAtTime(1,d.context.currentTime,.015))}),[u,l,d]),fe(n,(function(){return{input:s,A:l,B:d,output:void 0}}),[s,l,d]),Object(U.jsx)(ke,{id:n,inputs:["input"],outputs:["A","B"],title:"Output: ".concat(u),type:o,children:c&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)(Qt,{checked:"A"===u,labelOff:"B",labelOn:"A",onChange:f})})})})}var Mn=c.a.memo(An);function Dn(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.levels,i=void 0===o?256:o,r=t.max,u=void 0===r?1:r,s=t.min,l=void 0===s?-1:s,d=t.onChange;return Te(n,"quantizer-processor",{processorOptions:{levels:i,max:u,min:l}},[i,u,l]),Object(U.jsx)(ke,{id:n,inputs:["input"],outputs:["output"],title:"Quantizer",type:c,children:a&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsx)("div",{className:"customNode_item",style:{width:138},children:Object(U.jsx)("input",{onChange:function(e){return d({levels:+e.target.value})},step:1,title:"Levels",type:"number",value:i})}),Object(U.jsxs)("div",{className:"customNode_item",style:{width:138},children:[Object(U.jsx)("input",{onChange:function(e){return d({min:+e.target.value})},step:1,style:{width:"50%"},title:"Min",type:"number",value:l}),Object(U.jsx)("input",{onChange:function(e){return d({max:+e.target.value})},style:{width:"50%"},step:1,title:"Max>",type:"number",value:u})]})]})})}var En,Rn=c.a.memo(Dn);function qn(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.mode,i=void 0===o?En.HalfWave:o,r=t.onChange;return Te(n,"rectifier-processor",{processorOptions:{mode:i}},[i]),Object(U.jsx)(ke,{id:n,inputs:["input"],outputs:["output"],title:"Rectifier",type:c,children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("select",{onChange:function(e){return r({mode:e.target.value})},title:"Type",value:i,children:[Object(U.jsx)("option",{value:En.FullWave,children:En.FullWave}),Object(U.jsx)("option",{value:En.HalfWave,children:En.HalfWave})]})})})})}!function(e){e.FullWave="Full-wave",e.HalfWave="Half-wave"}(En||(En={}));var Fn,Bn,Wn,Pn=c.a.memo(qn);function zn(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.levels,i=void 0===o?256:o,r=t.max,u=void 0===r?1:r,s=t.min,l=void 0===s?-1:s,d=t.onChange,f=t.mode,p=void 0===f?Fn.OnSet:f;return Te(n,"aubio-processor",{processorOptions:{levels:i,max:u,min:l,mode:p}},[i,u,l,p]),Object(U.jsx)(ke,{id:n,inputs:["input"],outputs:["output",p],title:"Aubio: ".concat(p),type:c,children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",style:{width:138},children:Object(U.jsxs)("select",{style:{width:"100%"},onChange:function(e){return d({mode:e.target.value})},title:"Type",value:p,children:[Object(U.jsx)("option",{value:Fn.OnSet,children:Fn.OnSet}),Object(U.jsx)("option",{value:Fn.Bpm,children:Fn.Bpm}),Object(U.jsx)("option",{value:Fn.Pitch,children:Fn.Pitch})]})})})})}!function(e){e.OnSet="OnSet",e.Bpm="Bpm",e.Pitch="Pitch"}(Fn||(Fn={})),function(e){e.AttackTime="attack",e.DecayTime="decay",e.ReleaseTime="release",e.SustainLevel="sustain"}(Bn||(Bn={})),function(e){e.Attack="Attack",e.Decay="Decay",e.Release="Release",e.Sustain="Sustain"}(Wn||(Wn={}));var Ln=c.a.memo(zn),In=function(){var e=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:null===t||{deviceId:{exact:t.deviceId}},video:!1});case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log("Error:",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();function Gn(e){var t,n=e.id,c=e.type,o=e.selected,i=Object(a.useState)([]),r=Object(s.a)(i,2),u=r[0],l=r[1],d=Object(a.useState)(null),f=Object(s.a)(d,2),p=f[0],j=f[1],b=Object(a.useState)(),v=Object(s.a)(b,2),m=v[0],h=v[1],O=fe(n,(function(e){return e.createGain()}));return Object(a.useEffect)((function(){p&&h(p.label)}),[p]),Object(a.useEffect)((function(){navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((function(e){e.length&&l(e.filter((function(e){return"audioinput"===e.kind})))})).catch((function(e){console.log(e.name+": "+e.message)})):console.log("enumerateDevices() not supported.")}),[]),console.log(u),Object(U.jsxs)(ke,{id:n,outputs:["output"],type:c,title:"Source: AudioDevice",children:[Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("button",{onClick:function(){return console.log(p),void In(p).then((function(e){t=e,O.context.createMediaStreamSource(e).connect(O)}))},children:"\u25b6"}),Object(U.jsx)("button",{onClick:function(){O.context&&(t.getTracks().forEach((function(e){return e.stop()})),O.context.close(),window.location.reload())},children:"\u25fd"})]})}),o&&u.length>0&&Object(U.jsx)("select",{value:m,onChange:function(e){return j(u.find((function(t){return t.label===e.target.value})))},children:u&&u.map((function(e,t){return Object(U.jsx)("option",{children:e.label},t)}))})]})}var Hn,Qn=c.a.memo(Gn);function Xn(e){var t=e.id,n=e.type,a=Te("".concat(t,"_worklet"),"sample-and-hold-processor");return fe(t,(function(){var e;return e={},Object(ce.a)(e,Hn.HoldTime,a.parameters.get(Hn.HoldTime)),Object(ce.a)(e,"input",a),Object(ce.a)(e,"output",a),e}),[a]),Object(U.jsx)(ke,{id:t,inputs:["input",Hn.HoldTime],outputs:["output"],title:"Sample/Hold",type:n})}!function(e){e.HoldTime="holdTime"}(Hn||(Hn={}));var Kn=c.a.memo(Xn);function Un(e){var t=e.id,n=e.type;return Te(t,"sign-processor"),Object(U.jsx)(ke,{id:t,inputs:["input"],outputs:["output"],title:"Sign",type:n})}var Vn=c.a.memo(Un);var Yn=function(e,t){var n=t.pan,a=void 0===n?0:n,c=fe(e,(function(e){return e.createStereoPanner()}));return qe((function(){c.pan.value=a}),[c,a]),c};function Jn(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.pan,i=void 0===o?0:o,r=t.onChange,u="Stereo: ".concat(Math.abs(100*i).toFixed(0),"% ").concat(i>0?"Right":i<0?"Left":"");return Yn(n,{pan:i}),Object(U.jsx)(ke,{id:n,inputs:["input","pan"],outputs:["output"],title:u,type:c,children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{max:"1",min:"-1",onChange:function(e){return r({pan:+e.target.value})},step:"0.01",title:u,type:"range",value:i})})})})}var Zn=c.a.memo(Jn),$n={width:50};function ea(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.inputMax,i=void 0===o?1:o,r=t.inputMin,u=void 0===r?-1:r,s=t.onChange,l=t.outputMax,d=void 0===l?1:l,f=t.outputMin,p=void 0===f?0:f;return Te(n,"transformer-processor",{processorOptions:{inputMin:u,inputMax:i,outputMin:p,outputMax:d}},[u,i,p,d]),Object(U.jsx)(ke,{id:n,inputs:["input"],outputs:["output"],title:"Transformer",type:c,children:a&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("input",{onChange:function(e){return s({inputMin:+e.target.value})},style:$n,title:"Input min",type:"number",value:u}),Object(U.jsx)("span",{children:"\u2192"}),Object(U.jsx)("input",{onChange:function(e){return s({outputMin:+e.target.value})},style:$n,title:"Output min",type:"number",value:p})]}),Object(U.jsxs)("div",{className:"customNode_item",children:[Object(U.jsx)("input",{onChange:function(e){return s({inputMax:+e.target.value})},style:$n,title:"Input max",type:"number",value:i}),Object(U.jsx)("span",{children:"\u2192"}),Object(U.jsx)("input",{onChange:function(e){return s({outputMax:+e.target.value})},style:$n,title:"Output max",type:"number",value:d})]})]})})}var ta=c.a.memo(ea),na=d.a.mark(ca),aa=d.a.mark(oa);function ca(e,t){var n;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0;case 1:if(!(n<e)){a.next=7;break}return a.next=4,t(n);case 4:n++,a.next=1;break;case 7:case"end":return a.stop()}}),na)}function oa(e,t){var n,a;return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:n=Math.min(e.length,t.length),a=0;case 2:if(!(a<n)){c.next=8;break}return c.next=5,[e[a],t[a]];case 5:a++,c.next=2;break;case 8:case"end":return c.stop()}}),aa)}function ia(){}function ra(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),c=n[0],o=n[1],i=Object(a.useCallback)((function(t){t.key===e&&o(!0)}),[e]),r=Object(a.useCallback)((function(t){t.key===e&&o(!1)}),[e]);return Object(a.useEffect)((function(){return window.addEventListener("keydown",i),window.addEventListener("keyup",r),function(){window.removeEventListener("keydown",i),window.removeEventListener("keyup",r)}}),[i,r]),c}var ua=["onChange","value","largeStep","standardStep","smallStep"];var sa=function(e){var t=e.onChange,n=e.value,a=e.largeStep,c=void 0===a?10:a,o=e.standardStep,i=void 0===o?1:o,r=e.smallStep,u=void 0===r?.1:r,s=Object(pe.a)(e,ua),l=ra("Shift"),d=ra("Alt"),f=l?c:d?u:i;return Object(U.jsx)("input",Object(Y.a)(Object(Y.a)({},s),{},{type:"number",step:"0",onKeyDown:function(e){var a=e.key;function c(e){return Math.round(10*e)/10}"ArrowUp"===a?t(c(n+f)):"ArrowDown"===a&&t(c(n-f))},onChange:function(e){return t(+e.target.value)},value:n}))};function la(e){var t=e.filterDesc,n=e.bandStyle,c=e.onGainChange,o=e.onQChange,i=Object(a.useCallback)((function(e){c(gt(e.target.valueAsNumber))}),[c]);return Object(U.jsxs)("div",{className:"vocoderNode_bandStrip",children:[Object(U.jsx)("div",{className:"centerHz",children:t.hz}),Object(U.jsx)("div",{className:"colorSwatch",style:{background:n.freqColor}}),Object(U.jsx)("input",{type:"range",onChange:i,value:Ot(t.gainDb),max:3,min:1e-4,step:.001}),Object(U.jsx)(sa,{value:t.q,min:0,max:60,onChange:o})]})}var da=n(17),fa=n.n(da),pa=(n(70),Math.log2(1024)),ja=512,ba=4e3,va=[{hz:101,type:"lowpass",gainDb:-2.55,q:.55},{hz:154,type:"bandpass",gainDb:-2.4,q:2.96},{hz:208,type:"bandpass",gainDb:-2.4,q:4},{hz:285,type:"bandpass",gainDb:-3,q:3.55},{hz:395,type:"bandpass",gainDb:-2.5,q:3.7},{hz:542,type:"bandpass",gainDb:-3.12,q:3.75},{hz:720,type:"bandpass",gainDb:-2.8,q:3.7},{hz:1013,type:"bandpass",gainDb:-2.8,q:3.9},{hz:1495,type:"bandpass",gainDb:-3.4,q:3.2},{hz:2001,type:"bandpass",gainDb:-3.15,q:5.16},{hz:2546,type:"bandpass",gainDb:-2.8,q:4.48},{hz:3030,type:"highpass",gainDb:-2,q:.88}];function ma(e){for(var t=e.id,n=e.type,c=ht("".concat(t,"_modulate"),{}),o=Be("".concat(t,"_modulate_analyser"),{fftSizeExp:pa}),i=ht("".concat(t,"_carrier"),{}),r=ht("".concat(t,"_output"),{}),u=Object(a.useState)(Object(Rt.a)(va,ia)),l=Object(s.a)(u,2),d=l[0],f=l[1],p=Object(a.useState)(!1),j=Object(s.a)(p,2),b=j[0],v=j[1],m=c.context.sampleRate,h=d.map((function(e){var n,a=e.hz,c=e.type,o=e.gainDb,i=e.q,r=ht("".concat(t,"_modulate_gain_").concat(a),{gain:Ot(o),instant:!0});return{filter:He("".concat(t,"_modulate_filter1_").concat(a),{frequency:a,gain:0,type:c,Q:i}),gain:r,envelopeFollower:Te("".concat(t,"_modulate_envelope_").concat(a),"envelope-follower",{parameterData:(n={},Object(ce.a)(n,St.AttackTime,0),Object(ce.a)(n,St.ReleaseTime,3e-4),n)})}})),O=new Map,g=Float32Array.from(ca(240,(function(e){return 16.666666666666668*e+0}))),x=function(e){var t=Object(a.useMemo)((function(){var t=h[e],n=t.filter,a=t.gain,c=new Float32Array(g.length),o=new Float32Array(g.length);n.getFrequencyResponse(g,c,o);var i=c.map((function(e){return e*a.gain.value}));return{frequencies:g,magResponse:i,phaseResponse:o}}),[d[e]]);O.set(d[e].hz,t)},y=0;y<d.length;y++)x(y);var k=d.map((function(e){var n=e.hz,a=e.type,c=e.q;return{filter1:He("".concat(t,"_carrier_filter1_").concat(n),{frequency:n,gain:0,type:a,Q:c}),filter2:He("".concat(t,"_carrier_filter2_").concat(n),{frequency:n,gain:0,type:a,Q:c}),gain:ht("".concat(t,"_carrier_gain_").concat(n),{gain:0,instant:!0}),analyser:Be("".concat(t,"_carrier_analyser_").concat(n),{fftSizeExp:pa})}}));Object(a.useEffect)((function(){c.connect(o);var e,t=Object(jn.a)(h);try{for(t.s();!(e=t.n()).done;){var n=e.value,a=n.gain;[n.filter,a,n.envelopeFollower].reduce((function(e,t){return e?t?e.connect(t):e:t}))}}catch(v){t.e(v)}finally{t.f()}var i,u=Object(jn.a)(k.entries());try{for(u.s();!(i=u.n()).done;){var l=Object(s.a)(i.value,2),d=l[0],f=l[1],p=f.filter1,j=f.filter2,b=f.gain;[p,j,b,f.analyser].reduce((function(e,t){return e?t?e.connect(t):e:t})),h[d].envelopeFollower.connect(b.gain),b.connect(r)}}catch(v){u.e(v)}finally{u.f()}}),[r]),Object(a.useEffect)((function(){var e,t=Object(jn.a)(h);try{for(t.s();!(e=t.n()).done;){var n=e.value.filter;b?c.disconnect(n):c.connect(n)}}catch(u){t.e(u)}finally{t.f()}var a,o=Object(jn.a)(k);try{for(o.s();!(a=o.n()).done;){var r=a.value.filter1;b?i.disconnect(r):i.connect(r)}}catch(u){o.e(u)}finally{o.f()}}),[b]),fe(t,(function(){return{carrier:i,modulation:c,input:void 0,output:r,stop:function(){},disconnect:function(){le(i),le(c),le(r)}}}),[i,c,r]);var N=Object(a.useRef)(null);Object(a.useEffect)((function(){var e=N.current,t=null===e||void 0===e?void 0:e.getContext("2d");e&&t&&function(e,t,n){var a=n.min,c=n.max,o=e.canvas.height,i=e.canvas.width,r=function(e){return 0===e?0:Math.log10(e/100)},u=r(a),l=r(c),d=function(e){var t=r(e);return i*((t-u)/(l-u))};e.clearRect(0,0,i,o);var f,p=o/3,j=Object(jn.a)(va.entries());try{for(j.s();!(f=j.n()).done;){var b=Object(s.a)(f.value,2),v=b[0],m=b[1].hz,h=t.get(m),O=h.frequencies,g=h.magResponse,x=ga[v].responseColor;e.strokeStyle=fa()(x).alpha(.26).rgb().string(),e.lineWidth=2;var y=e.createLinearGradient(0,o,0,0);y.addColorStop(0,fa()(x).alpha(.15).rgb().string()),y.addColorStop(.2,fa()(x).alpha(.1).rgb().string()),y.addColorStop(1,fa()(x).alpha(.01).rgb().string());for(var k=!1,N=0,C=o,w=g.length,T=0;T<w;T++){N=d(O[T]);var _=o-p*g[T];C=Math.min(_,C),k?e.lineTo(N,_):(e.beginPath(),e.moveTo(N,_),k=!0)}e.stroke(),e.lineTo(N,o),e.lineTo(0,o),e.closePath(),e.fillStyle=y,e.fill()}}catch(S){j.e(S)}finally{j.f()}}(t,O,{min:0,max:ba})}),[O]);var C=Object(a.useRef)([]),w=Object(a.useRef)(null),T=Object(a.useCallback)((function(){var e,t,n=(e=va.length,t=function(e){var t=new Uint8Array(ja);return k[e].analyser.getByteFrequencyData(t),{frequency:va[e].hz,freqBins:t}},Array.from(ca(e,t)));return C.current=n,m}),[m].concat(Object(be.a)(k))),_=Object(a.useCallback)((function(e){var t=w.current,n=null===t||void 0===t?void 0:t.getContext("2d");t&&n&&function(e,t,n){var a=n.min,c=n.max,o=n.sampleRate;if(!t.length)return;if(t.length>ga.length)return void console.error("Not enough frequency colors");var i=e.canvas.height,r=e.canvas.width,u=function(e){return 0===e?0:Math.log10(e/100)},l=u(a),d=u(c),f=function(e){var t=u(e);return r*((t-l)/(d-l))};e.clearRect(0,0,r,i);var p,j=o/2,b=Math.floor(ja*(a/j)),v=Math.ceil(ja*(c/j)),m=v-b,h=j/ja,O=b*h,g=i-60,x=Object(jn.a)(t.entries());try{for(x.s();!(p=x.n()).done;){var y=Object(s.a)(p.value,2),k=y[0],N=y[1].freqBins,C=ga[k].freqColor;e.strokeStyle=C,e.lineWidth=2,e.beginPath();for(var w=0,T=!1,_=N.subarray(b,v),S=0;S<m;S++){w=f(O+S*h);var A=i-g*(_[S]/255);T?e.lineTo(w,A):(e.moveTo(w,A),T=!0)}e.stroke()}}catch(M){x.e(M)}finally{x.f()}}(n,C.current,{sampleRate:e,min:0,max:ba})}),[]),S=Object(a.useCallback)((function(){var e=T();_(e)}),[_,T]);return Ae(S,!b),Object(U.jsxs)(ke,{id:t,inputs:["carrier","modulation"],outputs:["output"],title:"Vocoder",type:n,children:[Object(U.jsxs)("div",{className:"vocoderNode_canvasHost",children:[Object(U.jsx)("canvas",{ref:w,style:{display:"block",width:800,height:400},width:"600",height:"300"}),Object(U.jsx)("canvas",{ref:N,className:"vocoderNode_overlayCanvas",width:"800",height:"400"}),Object(U.jsx)("button",{className:"vocoderNode_overlayPause",onClick:function(){return v(!b)},children:b?"Run":"Pause"})]}),Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"vocoderNode_bandStrips",children:d.map((function(e,t){return Object(U.jsx)(la,{filterDesc:e,bandStyle:ga[t],onGainChange:function(e){return f(Object(Rt.a)(d,(function(n){n[t].gainDb=e})))},onQChange:function(e){return f(Object(Rt.a)(d,(function(n){n[t].q=e})))}},e.hz)}))})})]})}var ha,Oa,ga=(ha=["#fff566","#b37feb","#5cdbd3","#85a5ff","#ff85c0","#95de64","#ffd666","#ff7875","#ff9c6e","#ffc069","#d3f261","#69c0ff"],Oa=["#ffec3d","#9254de","#36cfc9","#597ef7","#f759ab","#73d13d","#ffc53d","#ff4d4f","#ff7a45","#ffa940","#bae637","#40a9ff"],Array.from(oa(ha,Oa))).map((function(e){var t=Object(s.a)(e,2);return{freqColor:t[0],responseColor:t[1]}})),xa=c.a.memo(ma);function ya(e){var t,n=e.data,c=e.id,o=e.selected,i=e.type,r=n.onChange,u=n.oversample,l=Object(a.useState)(null!==(t=n.curveFn)&&void 0!==t?t:"const k = 50;\nconst samples = curve.length;\nconst deg = Math.PI / 180;\nfor (let i = 0; i < samples; i++) {\n  const x = (i * 2) / samples - 1;\n  curve[i] = ((3 + k) * x * 20 * deg) / (Math.PI + k * Math.abs(x));\n}\nreturn curve;"),d=Object(s.a)(l,2),f=d[0],p=d[1],j=Object(a.useState)(f),v=Object(s.a)(j,2),m=v[0],h=v[1],O=b().audioContext,g=Object(a.useMemo)((function(){var e=new Float32Array(O.sampleRate);return new Function("curve",m)(e)}),[O.sampleRate,m]);nt(c,{curve:g,oversample:u});var x=Object(a.useCallback)((function(){try{new Function("curve",f)(new Float32Array(O.sampleRate)),h(f),r({curveFn:f})}catch(e){console.error(e)}}),[O.sampleRate,f,r]);return Object(U.jsx)(ke,{id:c,inputs:["input"],outputs:["output"],type:i,children:o&&Object(U.jsxs)("div",{className:"customNode_editor nodrag",children:[Object(U.jsxs)("div",{className:"customNode_item",style:{flexWrap:"wrap"},children:[Object(U.jsx)("textarea",{onChange:function(e){return p(e.target.value)},rows:8,style:{width:"100%"},title:"Curve function",value:f}),Object(U.jsx)("button",{onClick:x,children:"save"})]}),Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsxs)("select",{onChange:function(e){return r({oversample:e.target.value})},title:"Oversample",value:u,children:[Object(U.jsx)("option",{value:"none",children:"none"}),Object(U.jsx)("option",{value:"2x",children:"2x"}),Object(U.jsx)("option",{value:"4x",children:"4x"})]})})]})})}var ka=c.a.memo(ya);function Na(e){var t=e.id,n=e.type,a=e.selected;return Object(U.jsx)(ke,{id:t,inputs:["input"],type:n,title:"WLED: ".concat(t.substring(0,11)),children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("input",{type:"text",title:"Host"})})})})}var Ca=c.a.memo(Na);function wa(e){var t=e.id,n=e.type;return Te(t,"xor-gate-processor",{numberOfInputs:2}),Object(U.jsx)(ke,{id:t,inputs:["input-0","input-1"],outputs:["output"],title:"Gate: XOR",type:n})}var Ta=c.a.memo(wa);function _a(e){var t=e.id,n=e.type,c=Object(a.useRef)(null);Object(a.useEffect)((function(){var e=c.current,t=null===e||void 0===e?void 0:e.getContext("2d");e&&t&&function(e){var t=e.canvas.height,n=e.canvas.width;e.clearRect(0,0,n,t),e.setLineDash([4,4]),e.fillStyle="#000000",e.font="20px monospace",e.lineWidth=1,e.strokeStyle="#000000",e.textAlign="center",e.textBaseline="middle",e.beginPath(),e.moveTo(30,t/2),e.lineTo(n-30,t/2),e.stroke(),e.closePath(),e.fillText("1",n/2,15),e.fillText("-1",n/2,t-15),e.beginPath(),e.moveTo(n/2,30),e.lineTo(n/2,t-30),e.stroke(),e.closePath(),e.fillText("1",n-15,t/2),e.fillText("-1",15,t/2)}(t)}),[]);var o=ut("".concat(t,"_gate"),{}),i=ut("".concat(t,"_x"),{}),r=ut("".concat(t,"_y"),{}),u=Object(a.useCallback)((function(e){var t=e.x,n=e.y;i.offset.setTargetAtTime(t,i.context.currentTime,.015),r.offset.setTargetAtTime(n,r.context.currentTime,.015)}),[i,r]),s=Object(a.useCallback)((function(){o.offset.value=1}),[o]),l=Object(a.useCallback)((function(){o.offset.value=0}),[o]);return fe(t,(function(){return{gate:o,input:void 0,output:void 0,x:i,y:r}}),[o,i,r]),Object(U.jsx)(ke,{id:t,outputs:["x","y","gate"],title:"XY Pad",type:n,children:Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)("canvas",{ref:c,height:400,onMouseMove:function(e){return u(function(e){var t=e.target.getBoundingClientRect();return{x:(e.clientX-t.left-t.width/2)/(t.width/2),y:-(e.clientY-t.top-t.height/2)/(t.height/2)}}(e))},style:{background:"white",cursor:"crosshair",height:200,width:200},width:400,onMouseDown:s,onMouseUp:l})})})})}var Sa=c.a.memo(_a);function Aa(e){var t=e.data,n=e.id,a=e.selected,c=e.type,o=t.gain,i=void 0===o?1:o,r=t.onChange,u="Gain: ".concat(i.toFixed(2));return ht(n,{gain:i,instant:!0}),Object(U.jsx)(ke,{id:n,inputs:["input","gain"],outputs:["output"],title:u,type:c,children:a&&Object(U.jsx)("div",{className:"customNode_editor nodrag",children:Object(U.jsx)("div",{className:"customNode_item",children:Object(U.jsx)(sa,{value:i,onChange:function(e){return r({gain:e})}})})})})}var Ma={ADSR:Se,Analyser:Pe,AndGate:Le,Aubio:Ln,AudioBufferSource:Ge,AudioDeviceSource:Qn,BiquadFilter:Ue,ChannelMerger:Ze,ChannelSplitter:tt,Clipper:ot,Comparator:rt,ConstantSource:lt,Delay:bt,DelayEffect:yt,Destination:Ct,DynamicsCompressor:At,EnvelopeFollower:Et,Equalizer:zt,Gain:It,Gate:Ht,InputSwitch:Vt,Keyboard:sn,Meter:pn,Metronome:hn,Noise:gn,NotGate:yn,OrGate:Nn,Oscillator:Tn,OscillatorNote:Sn,OutputSwitch:Mn,Quantizer:Rn,RawGain:c.a.memo(Aa),Rectifier:Pn,SampleAndHold:Kn,Vocoder:xa,Sign:Vn,StereoPanner:Zn,Transformer:ta,WaveShaper:ka,Wled:Ca,XorGate:Ta,XYPad:Sa};function Da(e){return e.source?Object.assign({},e,{style:{stroke:"#0dbed".concat(e.source.substr(-1))}}):e}function Ea(e,t){return Ra.apply(this,arguments)}function Ra(){return(Ra=Object(u.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.filter(r.h).reduce((function(e,t){return e[t.source]=!0,e[t.target]=!0,e}),{});case 1:if(!Object.keys(a).length){e.next=7;break}return Object.keys(n).forEach((function(e){delete a[e]})),e.next=5,new Promise((function(e){return setTimeout(e,0)}));case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var qa=10;function Fa(e){return Math.floor(e/qa)*qa}function Ba(){var e=ge(),t=e.elements,n=e.onChangeElementFactory,c=e.setElements,o=e.setTransform,i=e.transform,l=e.addElement,f=Z(),p=de().nodes,j=Object(a.useState)(null),b=Object(s.a)(j,2),v=b[0],m=b[1],h=function(){var e=de().getNode;return Object(a.useCallback)((function(t){return re(t,e)}),[e])}(),O=function(){var e=de().getNode;return Object(a.useCallback)((function(t){return ue(t,e)}),[e])}(),g=function(){var e=de().getNode;return Object(a.useCallback)((function(t){return le(e(t))}),[e])}(),x=Object(a.useCallback)(function(){var e=Object(u.a)(d.a.mark((function e(a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setTransform(i),c(t.map((function(e){return Object(r.i)(e)?Object(Y.a)(Object(Y.a)({},e),{},{data:Object(Y.a)(Object(Y.a)({},e.data),{},{onChange:n(e.id)})}):e}))),e.next=4,Ea(t,p);case 4:t.filter(r.h).forEach((function(e){return h(e)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),y=Object(a.useCallback)((function(e){o(e)}),[o]),k=Object(a.useCallback)((function(e,t){m(t)}),[]),N=Object(a.useCallback)((function(e){return m(null)}),[]),C=Object(a.useCallback)((function(e){c(Object(r.f)(Da(e),t)),h(e)}),[h,c,t]),w=Object(a.useCallback)((function(e){e.filter(r.h).forEach((function(e){return O(e)})),e.filter(r.i).forEach((function(e){return g(e.id)})),c(Object(r.j)(e,t))}),[O,g,c,t]),T=Object(a.useCallback)((function(e,n){O(e),c(Object(r.j)([e],t)),c(Object(r.f)(Da(n),t)),h(n)}),[O,h,c,t]),_=Object(a.useCallback)((function(e,n){c(t.map((function(e){return Object(r.i)(e)&&e.id===n.id?Object(Y.a)(Object(Y.a)({},e),{},{position:{x:Fa(n.position.x),y:Fa(n.position.y)}}):e})))}),[c,t]),S=Object(a.useCallback)((function(e){var t="".concat(e,"-").concat(Object(je.a)()),a=n(t),c={x:Fa((f.getRect().left-i.x)/i.zoom),y:Fa((f.getRect().top-i.y)/i.zoom)};l({id:t,data:{onChange:a},type:e,position:c}),f.hide()}),[f,n,i,l]),A=Object(a.useCallback)((function(){f.hide()}),[f]),M=Object(a.useCallback)((function(e){e.preventDefault(),f.setRect({width:0,height:0,top:e.clientY,right:0,bottom:0,left:e.clientX}),f.show(Object(U.jsx)(ae,{addNode:S}))}),[S,f]);return Object(U.jsx)(U.Fragment,{children:Object(U.jsxs)(r.g,{"data-connecting-handletype":v?v.handleType:void 0,defaultPosition:[i.x,i.y],defaultZoom:i.zoom,elements:t,nodeTypes:Ma,onConnect:C,onConnectStart:k,onConnectStop:N,onEdgeUpdate:T,onElementsRemove:w,onLoad:x,onMoveEnd:y,onNodeDragStop:_,onPaneClick:A,onPaneContextMenu:M,onlyRenderVisibleElements:!1,selectNodesOnDrag:!1,snapToGrid:!0,snapGrid:[qa,qa],style:{zIndex:0},children:[Object(U.jsx)(r.a,{gap:qa}),Object(U.jsx)(r.b,{})]})})}var Wa=c.a.memo(Ba),Pa=n.p+"static/media/logo.7b27df5c.svg",za={fontSize:12,height:"100%",resize:"none",width:"100%"},La={display:"flex",position:"absolute",right:"100%",top:80,transform:"rotate(-90deg)",transformOrigin:"bottom right"},Ia={display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"2rem",position:"absolute",left:0,right:0,top:0,height:70,backgroundColor:"#0dbedc",backgroundSize:"25%",backgroundRepeat:"no-repeat",backgroundPosition:"-5% center"};var Ga=function(){var e=ge(),t=e.elements,n=e.id,c=e.setElements,o=e.setId,i=e.setTransform,r=e.transform,u=e.clear,l=e.set,d=Object(a.useState)(!1),f=Object(s.a)(d,2),p=f[0],j=f[1],b=Object(a.useMemo)((function(){return function(e){return{height:"calc(100% - 70px)",padding:10,position:"absolute",right:0,top:70,transform:e?"translateX(0)":"translateX(100%)",transition:"transform 0.4s ease",width:400}}(p)}),[p]);return Object(a.useEffect)((function(){if(window.location.hash){var e,t=atob(null===(e=window.location.hash)||void 0===e?void 0:e.substr(1));try{l(JSON.parse(t))}catch(n){console.error(n)}}}),[l]),Object(a.useEffect)((function(){console.log("share link","".concat(window.location.href,"/#").concat(btoa(JSON.stringify({elements:t,id:n,transform:r}))))}),[t,n,r]),Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("div",{style:Object(Y.a)(Object(Y.a)({},Ia),{},{backgroundImage:"url(".concat(Pa,")")}),children:Object(U.jsx)("button",{onClick:function(){document.querySelectorAll("body")[0].classList.toggle("darkmode")},children:"toggle darkmode"})}),Object(U.jsxs)("div",{style:b,children:[Object(U.jsx)("textarea",{onChange:function(e){try{var t,n=JSON.parse(null!==(t=e.target.value)&&void 0!==t?t:""),a=n.elements,r=n.id,u=n.transform;c(a),o(r),i(u)}catch(e){console.error(e)}},style:za,value:JSON.stringify({elements:t.map((function(e){return Object(Y.a)(Object(Y.a)({},e),{},{__rf:void 0})})),id:n,transform:r},null,2)}),Object(U.jsxs)("div",{style:La,children:[Object(U.jsx)("button",{onClick:function(){return u()},style:{marginRight:10},children:"clear"}),Object(U.jsx)("button",{onClick:function(){return j((function(e){return!e}))},children:p?"hide":"show"})]})]})]})};var Ha=function(){var e=ge();return Object(U.jsx)(V,{children:Object(U.jsx)(r.e,{children:Object(U.jsx)(ee,{children:Object(U.jsxs)("div",{style:{alignItems:"stretch",display:"flex",height:"100vh"},children:[Object(U.jsx)(Wa,{},e.id),Object(U.jsx)(Ga,{})]})})})})},Qa=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,78)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),o(e),i(e)}))};i.a.render(Object(U.jsx)(c.a.StrictMode,{children:Object(U.jsx)(Ha,{})}),document.getElementById("root")),Qa()}},[[71,1,2]]]);
//# sourceMappingURL=main.745e331d.chunk.js.map